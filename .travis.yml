sudo : true
language : java

install:
  - curl http://jflex.de/release/jflex-1.6.1.tar.gz --output jflex-1.6.1.tar.gz
  - sudo tar -C /usr/share -xvzf jflex-1.6.1.tar.gz
  - sudo ln -s /usr/share/jflex-1.6.1/bin/jflex /usr/bin/jflex

script : make
after_script : make fclean

stages:
  - Base Compilation
  - Unit Test
  - Final

jobs:
  include:
    - os: linux
      jdk: oraclejdk8
      stage: Base Compilation
      env:
         - NAME="Linux"
    - os: linux
      jdk: oraclejdk9
      stage: Base Compilation
      env:
         - NAME="Linux"
    - os: linux
      jdk: openjdk8
      stage: Base Compilation
      env:
         - NAME="Linux"
    - os: osx
      stage: Base Compilation
      env:
         - NAME="Mac OS"

jobs:
  include:
    - os: linux
      jdk: oraclejdk8
      stage: Unit Test
      script : make basic_test
      env :
         - NAME="Basic test"
    - os: linux
      jdk: oraclejdk9
      stage: Unit Test
      script : make basic_test
      env :
         - NAME="Basic test"
    - os: linux
      jdk: openjdk8
      stage: Unit Test
      script : make basic_test
      env :
         - NAME="Basic test"
    - os: osx
      stage: Unit Test
      script : make basic_test
      env :
         - NAME="Basic test"
    - os: linux
      jdk: oraclejdk8
      stage: Unit Test
      script : make sys_test
      env :
         - NAME="Sys test"
    - os: linux
      jdk: oraclejdk9
      stage: Unit Test
      script : make sys_test
      env :
         - NAME="Sys test"
    - os: linux
      jdk: openjdk8
      stage: Unit Test
      script : make sys_test
      env :
         - NAME="Sys test"
    - os: osx
      stage: Unit Test
      script : make sys_test
      env :
         - NAME="Sys test"
    - os: linux
      jdk: oraclejdk8
      stage: Unit Test
      script : make bonus_test
      env :
         - NAME="Bonus test"
    - os: linux
      jdk: oraclejdk9
      stage: Unit Test
      script : make bonus_test
      env :
         - NAME="Bonus test"
    - os: linux
      jdk: openjdk8
      stage: Unit Test
      script : make bonus_test
      env :
         - NAME="Bonus test"
    - os: osx
      stage: Unit Test
      script : make bonus_test
      env :
         - NAME="Bonus test"

jobs:
  include:
    - os: linux
      stage: Final
      script : make test
      env :
         - NAME="Full Build All"
